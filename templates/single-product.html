{% extends "base.html" %} {% block content %}
<div class="max-w-7xl mx-auto px-6 py-16">
  <div class="flex flex-col lg:flex-row gap-20">
    <div class="flex-1 space-y-6">
      <div
        class="aspect-[4/5] rounded-[3.5rem] overflow-hidden bg-white shadow-2xl border border-slate-100"
      >
        <img
          id="main-img"
          src=""
          class="w-full h-full object-cover transition-all duration-700"
          alt=""
        />
      </div>
      <div
        id="thumb-container"
        class="flex gap-4 overflow-x-auto pb-4 scrollbar-hide"
      ></div>
    </div>

    <div class="flex-1 flex flex-col justify-center max-w-xl">
      <nav
        class="flex space-x-2 text-[10px] font-bold uppercase tracking-[0.2em] text-slate-400 mb-8"
      >
        <a href="/shop" class="hover:text-indigo-600">Shop</a>
        <span>/</span>
        <span id="breadcrumb-cat" class="text-slate-900"></span>
      </nav>

      <h1
        id="p-name"
        class="text-5xl md:text-6xl font-[900] text-slate-900 tracking-tighter leading-none italic"
      >
        <span class="text-indigo-600">.</span>
      </h1>

      <div class="mt-6 flex items-center space-x-6">
        <p id="p-price" class="text-3xl font-black text-slate-900"></p>
        <span
          id="stock-badge"
          class="px-3 py-1 bg-indigo-50 text-indigo-600 text-[10px] font-bold rounded-full uppercase tracking-widest"
        >
          In Stock
        </span>
      </div>

      <div class="mt-10 space-y-6">
        <p
          id="p-desc"
          class="text-slate-500 leading-relaxed text-lg font-medium"
        ></p>
      </div>
      <div>
        <h4
          class="text-[10px] font-bold uppercase tracking-widest text-slate-400 mb-4"
        >
          Available Colors
        </h4>
        <div id="color-container" class="flex gap-3"></div>
      </div>

      <div class="mt-12 flex flex-col sm:flex-row gap-4">
        <a
          id="cart-btn"
          href="#"
          class="flex-1 bg-slate-900 text-white text-center py-6 rounded-[2rem] font-bold text-sm uppercase tracking-widest hover:bg-indigo-600 transition-all shadow-2xl"
        >
          Add to Cart
        </a>
        <a
          id="wishlist-btn"
          href="#"
          class="px-8 py-6 bg-slate-50 text-slate-400 rounded-[2rem] font-bold flex items-center justify-center hover:text-indigo-600 transition"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            stroke-width="2"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"
            />
          </svg>
        </a>
      </div>

      <div
        class="mt-12 pt-10 border-t border-slate-100 grid grid-cols-2 gap-8 text-[11px] font-bold uppercase tracking-widest text-slate-400"
      >
        <div>
          <p class="text-slate-900 mb-1">Brand</p>
          <p id="p-brand"></p>
        </div>
        <div>
          <p class="text-slate-900 mb-1">Category</p>
          <p id="p-cat"></p>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const productId = window.location.pathname.split("/").pop();

    fetch(`/api/single_product/${productId}`)
      .then((res) => res.json())
      .then((product) => {
        if (product.error) {
          window.location.href = "/shop";
          return;
        }

        document.getElementById("p-name").innerHTML =
          `${product.name}<span class="text-indigo-600">.</span>`;
        document.getElementById("p-price").innerText = `$${product.price}`;
        document.getElementById("p-desc").innerText =
          product.description || "Premium quality piece.";
        document.getElementById("breadcrumb-cat").innerText = product.category;
        document.getElementById("p-brand").innerText = product.brand;
        document.getElementById("p-cat").innerText = product.category;

        const mainImg = document.getElementById("main-img");
        mainImg.src = product.image;

        document.getElementById("cart-btn").href = `/add_cart/${product.id}`;
        document.getElementById("wishlist-btn").href =
          `/wishlist_product/${product.id}`;

        if (product.quantity <= 0) {
          const btn = document.getElementById("cart-btn");
          btn.innerText = "Out of Stock";
          btn.classList.add("bg-red-50", "text-red-500", "cursor-not-allowed");
          btn.href = "#";
        }
        const color = product.colors ? product.colors[0] : null;

        document.getElementById("color-container").innerHTML = color
          ? `<div class="w-8 h-8 rounded-full border-2 border-white ring-1 ring-slate-200 shadow-sm" style="background-color: ${color};"></div>`
          : "";
      });
  });
</script>
{% endblock %}
